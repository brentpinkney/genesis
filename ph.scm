;;; (v)	= (environment)
(!v($(EV)V))

;;; ('E) (quote e)
(!'($(EV)(#E)))

;;; (aE) (atom? e)
(!a(^(E)(?E(?(tE)()E)())))

;;; (kEFGH…) (list e f g h …)
(!k($(EV)(oEV)))

;;; (,XY) (append X Y)
(!,(^(XY)(?X(.(#X)(,(%X)Y))Y)))

;;; (mFL) (map f l)
(!m(^(FL)(?L(.(F(#L))(mF(%L)))())))

;;; (fFXL) (fold f x l)
(!f(^(FXL)(?L(fF(F(#L)X)(%L))X)))

;;; (:XL) (memq? x l)
(!:(^(XL)(?L(?(=X(#L))L(:X(%L)))())))

;;; (bEFGH…) (begin e f g h …)
(!b($(EV)(e(k(,(k('^)())E)))))

;;; (l) and named let
(!l($(EV)
     (? (s(#E))
	(e(k(,(k('^)(k(#E)))(k(.(#E)(m#(m%(#(%E)))))))
	    (,(k('^)(m#(#(%E))))(%(%E)))))
	(e(.(,(k('^)(m#(#E)))(%E))(m#(m%(#E))))))))

;;; (~E) (not e)
(!~(^(E)(?E()0x00)))

;;; (|XYZ…) (or z y z …)
(!| ($ (KV)
       (? K
	  (l L ((F (e(#K))) (R (%K)))
	     (? F
		F
		(? R
		   (L (e(#R)) (%R))
		   ())))
	  ())))

;;; (&XYZ…) (and z y z …)
(!& ($ (KV)
       (? K
	  (l L ((F (e(#K))) (R (%K)))
	     (? F
		(? R
		   (L (e(#R)) (%R))
		   F)
		()))
	  ())))

;;; rnull()
(!n (@ 0x25 0x00 0x48 0x89 0xf8 0xc3 )) ; mov rax,rdi; ret

;;; r42() 
(!x (@ 0x25                                              ; procedure
       0x00                                              ; no args
       0xbe 0x2a 0x00 0x00 0x00                          ; mov    esi,0x3a
       0x49 0xba 0xfb 0x00 0x00 0x00 0x00 0x00 0x00 0x00 ; movabs r10,0xfb = key of integer()
       0x41 0xff 0xd2                                    ; call   r10
       0xc3))                                            ; ret     
       
;;; (+ a b) 
(!+ (@ 0x25                                                     ; procedure
       0x02							; a, b
       0x48 0x8b 0x36						; mov    rsi,QWORD PTR [rsi]
       0x48 0x81 0xe6 0x00 0xff 0x00 0x00			; and    rsi,0xff00
       0x48 0xc1 0xee 0x08					; shr    rsi,0x8
       0x48 0x8b 0x12						; mov    rdx,QWORD PTR [rdx]
       0x48 0x81 0xe2 0x00 0xff 0x00 0x00			; and    rdx,0xff00
       0x48 0xc1 0xea 0x08					; shr    rdx,0x8
       0x48 0x01 0xd6						; add    rsi,rdx
       0x49 0xba 0xfb 0x00 0x00 0x00 0x00 0x00 0x00 0x00 	; movabs r10,0xfb = key of integer()
       0x41 0xff 0xd2						; call   r10
       0xc3))							; ret

;;; (- a b) 
(!- (@ 0x25                                                     ; procedure
       0x02							; a, b
       0x48 0x8b 0x36						; mov    rsi,QWORD PTR [rsi]
       0x48 0x81 0xe6 0x00 0xff 0x00 0x00			; and    rsi,0xff00
       0x48 0xc1 0xee 0x08					; shr    rsi,0x8
       0x48 0x8b 0x12						; mov    rdx,QWORD PTR [rdx]
       0x48 0x81 0xe2 0x00 0xff 0x00 0x00			; and    rdx,0xff00
       0x48 0xc1 0xea 0x08					; shr    rdx,0x8
       0x48 0x29 0xd6						; sub    rsi,rdx
       0x49 0xba 0xfb 0x00 0x00 0x00 0x00 0x00 0x00 0x00 	; movabs r10,0xfb = key of integer()
       0x41 0xff 0xd2						; call   r10
       0xc3))							; ret

;;; (* a b) 
(!* (@ 0x25                                                     ; procedure
       0x02							; a, b
       0x48 0x8b 0x36						; mov    rsi,QWORD PTR [rsi]
       0x48 0x81 0xe6 0x00 0xff 0x00 0x00			; and    rsi,0xff00
       0x48 0xc1 0xee 0x08					; shr    rsi,0x8
       0x48 0x8b 0x12						; mov    rdx,QWORD PTR [rdx]
       0x48 0x81 0xe2 0x00 0xff 0x00 0x00			; and    rdx,0xff00
       0x48 0xc1 0xea 0x08					; shr    rdx,0x8
       0x48 0x0f 0xaf 0xf2					; imul   rsi,rdx
       0x49 0xba 0xfb 0x00 0x00 0x00 0x00 0x00 0x00 0x00 	; movabs r10,0xfb = key of integer()
       0x41 0xff 0xd2						; call   r10
       0xc3))							; ret

;;; (fN) (factorial n)
(!f(^(N)(?(=N0x00)0x01(*N(f(-N0x01))))))

